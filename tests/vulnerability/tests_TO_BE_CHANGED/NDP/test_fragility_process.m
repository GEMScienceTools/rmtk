% Test for nonlinear dynamic analysis post-processing in the RMTK framework
%
% Created by Chiara Casotto
% 17-2-2015

clc;clear all; close all;
addpath('/Users/chiaracasotto/Documents/PHD/Scripts4fragility/')
% INPUT data: IM levels, number of analyses, and number of collapses
IM = [49.852, 47.056 , 33.012 , 82.125 , 37.499 , 3.159 , 52.205 , 88.363 ,...
    290.11  , 241.78  , 273.37  , 151.24  , 92.957 , 40.101 , 97.535 , 54.723 ,...
    26.081 , 105.61  , 156.81  , 82.401 , 26.807 ];
num_gms = ones(1,length(IM))*100;
num_collapse = [0.7	0.46	0.41	0.76	0.42	0	0.7	0.93	...
                1	1	1	1	0.96	0.24	0.9	0.6	0.2	0.96	0.81	0.99	0.05;...
                0.54	0.31	0.31	0.5	0.37	0	0.46	0.58	1	0.95	1	0.88...
                0.72	0.08	0.65	0.43	0.16	0.59	0.41	0.6	0];

% estimate fragility function using MLE method (equation 11)
for i=1:size(num_collapse,1)
    [theta_hat(i), beta_hat(i)] = fn_mle_pc_probit(IM, num_gms, num_collapse(i,:)*100);
end

xlswrite('results/fragility_process_matlab.xls',[theta_hat' beta_hat'])





