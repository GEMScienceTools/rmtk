clear all
clc
close all
addpath('/Users/chiaracasotto/Documents/GEM/RMTK/DimitriosFiles/');

Gamma = 1.292;
T = 1.612;
Tav = 1.612;
Sa_ratios = 1;
noBlg = 1;
w = 1;
g=9.81;
MC = 25;
vecs = csvread('../fragility_process/inputs/EDPvec-RDvec.csv');
EDPvec{1} = vecs(:,1);
RDvec{1} = vecs(:,2);
EDPvec{2} = [];
RDvec{2} = [];

SPO	=  [0.0951510, 0.940278828, 2093.9]; %d and F
dy = SPO(1);
du = SPO(2);
dlim	= [0.002, 0.005, 0.01, 0.02, 0.04, 0.06, 0.08;...
    0.046144456, 0.107312842, 0.212491246, 0.473466774, 0.724976013, 0.940278828, 0.940278828];
bUthd	= [0 0.25];
dry = SPO(1);
du = SPO(2);

counter = 1;
for edp = 1:length(EDPvec)
    for disp = 1:length(bUthd)
        for i = 1:length(dlim)
            [Sa50,bTSa]=RGMfragility(dry,dlim(edp,i),bUthd(disp),du,T,...
                Gamma,EDPvec{edp},RDvec{edp},g,MC);
            SaT(counter,i) = Sa50;
            b(counter,i) = bTSa;
        end
        counter = counter+1;
    end
end

xlswrite(horzcat('./results/RGM_fragility_matlab.xls'),[SaT; b])