
clc; clear all; close all
an_type = [{'RGM'},{'SPO2IDA'},{'DF'}];
out_type=[{'EDP-RD beta_c=0'},{'EDP-RD beta_c=0.25'},{'RD beta_c=0'},{'RD beta_c=0.25'}];
iml = linspace(0.01,2);
colors = {'y','g','c','b','m','r','k'};
plotflag = 1;

%% MULTIPLE BUILDING SINGLE OPTION
stat = csvread(horzcat('./results/fragility_process.csv'), 1, 1);
statm = csvread(horzcat('./results/fragility_process_matlab.csv'),0,0);
figure
thetam = statm(:,1);
betam = statm(:,2);
theta = stat(:,1);
beta = stat(:,2);

for j=1:length(thetam)
    DSm =  logncdf(iml,log(thetam(j)),betam(j));
    if betam(j) ==0
        DSm(iml<thetam(j))=0;
        DSm(iml>=thetam(j))=1;
    end
    DS = logncdf(iml,log(theta(j)),beta(j));
    if beta(j)==0
        DS(iml<theta(j))=0;
        DS(iml>=theta(j))=1;
    end
    plot(iml,DSm,colors{j},'DisplayName',horzcat('DS',num2str(j),'-matlab'))
    hold on
    plot(iml,DS,colors{j},'Linestyle','--','DisplayName',horzcat('DS',num2str(j),'-RMTK'))
end
title('DF EDP-RD beta_c=0.25');
legend1=legend('show');
set(legend1,'Location','Southeast','FontSize',6);
ylabel('Probability of Exceedance','FontSize',9);
xlabel('Sa(T) [g]','FontSize',9);
set(gca,'FontSize',7);
legend boxoff
if plotflag
    xSize = 10; ySize = 6;
    xLeft = (21-xSize)/2; yTop = (30-ySize)/2;
    set(gcf,'PaperUnits','centimeters');
    set(gcf,'PaperPosition',[xLeft yTop xSize ySize])
    set(gcf,'Position',[5 5 xSize*10 ySize*10])
    fnam='multiple_blgs.fig';
    fpat=horzcat('./results/');

    saveas(gcf,[fpat,filesep,fnam],'fig')
    fnam='multiple_blgs.eps';
    fpat=horzcat('./results/',fnam);
    print('-depsc2',fpat)
end
        
%% SINGLE BUILDING DIFFERENT OPTIONS
    
for i=1:length(an_type)
    stat = csvread(horzcat('./results/',an_type{i},'_fragility.csv'), 1, 1);
    statm = csvread(horzcat('./results/',an_type{i},'_fragility_matlab.csv'),0,0);
    for k=1:length(statm)/2
        thetam = statm(k,:);
        betam = statm(k+4,:);
        theta = stat(:,(k-1)*2+1);
        beta = stat(:,(k-1)*2+2);
        figure
        for j=1:length(thetam)
            DSm =  logncdf(iml,log(thetam(j)),betam(j));
            if betam(j) ==0
                DSm(iml<thetam(j))=0;
                DSm(iml>=thetam(j))=1;
            end
            DS = logncdf(iml,log(theta(j)),beta(j));
            if beta(j)==0
                DS(iml<theta(j))=0;
                DS(iml>=theta(j))=1;
            end
            plot(iml,DSm,colors{j},'DisplayName',horzcat('DS',num2str(j),'-matlab'))
            hold on
            plot(iml,DS,colors{j},'Linestyle','--','DisplayName',horzcat('DS',num2str(j),'-RMTK'))
        end
        title(horzcat(an_type{i},' ',out_type{k}));
        legend1=legend('show');
        set(legend1,'Location','Southeast','FontSize',6);
        ylabel('Probability of Exceedance','FontSize',9);
        xlabel('Sa(T) [g]','FontSize',9);
        set(gca,'FontSize',7);
        legend boxoff
        if plotflag
            xSize = 10; ySize = 6;
            xLeft = (21-xSize)/2; yTop = (30-ySize)/2;
            set(gcf,'PaperUnits','centimeters');
            set(gcf,'PaperPosition',[xLeft yTop xSize ySize])
            set(gcf,'Position',[5 5 xSize*10 ySize*10])
            fnam=(horzcat(an_type{i},'_',out_type{k},'.fig'));
            fpat=horzcat('./results/');
            
            saveas(gcf,[fpat,filesep,fnam],'fig')
            fnam=horzcat(an_type{i},'_',out_type{k},'.eps');
            fpat=horzcat('./results/',fnam);
            print('-depsc2',fpat)
        end
    end
end